inner_join(. , fus_bens_plot %>% select(target_id, percent), by = "target_id") %>%
ggplot(aes(x = percent.x, y = percent.y)) +
geom_point()
mito <- c("ENST00000361390",
"ENST00000361453",
"ENST00000361624",
"ENST00000361899",
"ENST00000361381",
"ENST00000361567",
"ENST00000361789")
test <- fus2_bens_plot %>% select(target_id, percent) %>%
inner_join(. , fus_bens_plot %>% select(target_id, percent), by = "target_id")
geom_point(data = test %>% filter(target_id %in% mito,  color= "red")
ggplot(data= test, aes(x = percent.x, y = percent.y)) +
geom_point() +
geom_point(data = test %>% filter(target_id %in% mito,  color= "red"))
ggplot(data= test, aes(x = percent.x, y = percent.y)) +
geom_point() +
geom_point(data = test %>% filter(target_id %in% mito,  color= "red"))
ggplot(data= test, aes(x = percent.x, y = percent.y)) +
geom_point() +
geom_point(data = test %>% filter(target_id %in% mito),  color= "red")
test %>% filter(target_id %in% mito)
test <- fus2_bens_plot %>% select(target_id, percent) %>%
inner_join(. , fus_bens_plot %>% select(target_id, percent), by = "target_id") %>%
as.data_frame()
test <- fus2_bens_plot %>% select(target_id, percent) %>%
inner_join(. , fus_bens_plot %>% select(target_id, percent), by = "target_id") %>%
as.data.frame()
str(test)
test <- fus2_bens_plot %>% select(target_id, percent) %>%
inner_join(. , fus_bens_plot %>% select(target_id, percent), by = "target_id") %>%
mutate(target_id = as.character(target_id))
str(test)
ggplot(data= test, aes(x = percent.x, y = percent.y)) +
geom_point() +
geom_point(data = test %>% filter(target_id %in% mito),  color= "red")
test %>% filter(target_id %in% mito)
test %>% filter(grep(mito[1], test$target_id)
)
grep(mito[1], test$target_id
)
grep(mito[2], test$target_id
)
fus2_bens_plot
ggplot(data= test, aes(x = percent.x, y = percent.y)) +
geom_point() +
geom_point(data = test %>% filter(target_id == "ENST00000234590.10"),  color= "red")
test %>% filter(target_id == "ENST00000234590.10")
test %>% filter(percent == 100)
head(test)
fus2_bens_plot %>% filter(percent == 100)
View(fus2_bens_plot %>% filter(percent == 100))
mito <- c("ENST00000361390",
"ENST00000361453",
"ENST00000361624",
"ENST00000361899",
"ENST00000361381",
"ENST00000361567",
"ENST00000361789")
ggplot(data= test, aes(x = percent.x, y = percent.y)) +
geom_point() +
geom_point(data = test %>% filter(target_id == "ENST00000361390.2"),  color= "red")
fus2_bens_plot %>% filter(percent == 100) %>% filter(grep("ENST00000361453", fus2_bens_plot$target_id))
grep("ENST00000361453", fus2_bens_plot$target_id)
fus2_bens_plot %>% filter(percent == 100)
mito <- c("ENST00000361390.2",
"ENST00000361453",
"ENST00000361624",
"ENST00000361899",
"ENST00000361381",
"ENST00000361567",
"ENST00000361789")
fus2_bens_plot %>% filter(percent == 100) %>% filter(grepl("ENST00000361453", fus2_bens_plot$target_id))
fus2_bens_plot %>% filter(percent == 100) %>% filter(grepl("ENST00000361453", .$target_id))
fus2_bens_plot %>% filter(percent == 100) %>% filter(grepl("ENST00000361390", .$target_id))
fus2_bens_plot %>% filter(percent == 100) %>% filter(grepl("ENST00000361624", .$target_id))
fus2_bens_plot %>% filter(percent == 100) %>% filter(grepl("ENST00000361899", .$target_id))
test %>% filter(percent == 100) %>% filter(grepl("ENST00000361899", .$target_id))
ggplot(data= test, aes(x = percent.x, y = percent.y)) +
geom_point() +
geom_point(data = test %>% filter(target_id == "ENST00000361899.2"),  color= "red")
fus2_bens_plot %>% filter(percent == 100) %>% filter(grepl(mito, .$target_id))
ool17_bens_plot
fus2_bens_plot
# ---- DATA FROM FUS DROPLETS --- #
fus_input_tpm <- master %>%
filter(experiment == "ool22_input") %>%
filter(tpm != 0) %>%
group_by(target_id) %>%
summarise(fus_input_tpm = log2_tpm)
fus_bens_plot <- master %>%
filter(tpm != 0) %>%
filter(experiment == "ool22") %>%
group_by(target_id) %>%
summarise(ave_tpm = mean(log2_tpm), count = n(), ave_pseudo = mean(p_pseudoaligned), sd_pseudo = sd(p_pseudoaligned)) %>%
inner_join(.,fus_input_tpm, by="target_id") %>% distinct() %>%
arrange(desc(count)) %>%
mutate(percent = count*100/max(count))
plot(fus_bens_plot$ave_pseudo,fus_bens_plot$percent, ylab = "Detected in x% of droplets", xlab = "Ave Pseudoaligned", main = "FUS Droplets")
# ---- DATA FROM BAD!! FUS DROPLETS --- #
fus2_input_tpm <- master_fus2 %>%
filter(experiment == "ool23_input") %>%
filter(tpm != 0) %>%
group_by(target_id) %>%
summarise(fus2_input_tpm = log2_tpm)
fus2_bens_plot <- master_fus2 %>%
filter(tpm != 0) %>%
filter(experiment == "ool23") %>%
group_by(target_id) %>%
summarise(ave_tpm = mean(log2_tpm), count = n(), ave_pseudo = mean(p_pseudoaligned), sd_pseudo = sd(p_pseudoaligned)) %>%
inner_join(.,fus2_input_tpm, by="target_id") %>% distinct() %>%
arrange(desc(count)) %>%
mutate(percent = count*100/max(count))
fus2_bens_plot
hist(fus2_bens_plot$ave_pseudo)
hist(scale(fus2_bens_plot$ave_pseudo))
hist(scale(fus_bens_plot$ave_pseudo))
hist((fus2_bens_plot$ave_pseudo))
hist((fus_bens_plot$ave_pseudo))
inner_join(. , fus2_bens_plot, by = "target_id", suffix = c("_good", "_bad")) %>%
mutate(target_id = as.character(target_id))
test <- fus_bens_plot %>%
inner_join(. , fus2_bens_plot, by = "target_id", suffix = c("_good", "_bad")) %>%
mutate(target_id = as.character(target_id))
test
test <- fus_bens_plot %>%
inner_join(. , fus2_bens_plot, by = "target_id", suffix = c("_good", "_bad")) %>%
mutate(target_id = as.character(target_id)) %>%
mutate(delta_align = ave_pseudo_good - ave_pseudo_bad)
test
test <- fus_bens_plot %>%
inner_join(. , fus2_bens_plot, by = "target_id", suffix = c("_good", "_bad")) %>%
mutate(target_id = as.character(target_id)) %>%
mutate(delta_align = ave_pseudo_good - ave_pseudo_bad) %>%
mutate(delta_percent = percent_good - percent_bad) %>%
select(target_id, delta_align, delta_percent)
test
test <- fus_bens_plot %>%
inner_join(. , fus2_bens_plot, by = "target_id", suffix = c("_good", "_bad")) %>%
mutate(target_id = as.character(target_id)) %>%
mutate(delta_align = ave_pseudo_good - ave_pseudo_bad) %>%
mutate(delta_percent = percent_good - percent_bad) %>%
select(target_id, delta_align, delta_percent) %>%
ggplot(aes(x = delta_align, y = delta_percent)) +
geom_point()
fus_bens_plot %>%
inner_join(. , fus2_bens_plot, by = "target_id", suffix = c("_good", "_bad")) %>%
mutate(target_id = as.character(target_id)) %>%
mutate(delta_align = ave_pseudo_good - ave_pseudo_bad) %>%
mutate(delta_percent = percent_good - percent_bad) %>%
select(target_id, delta_align, delta_percent) %>%
ggplot(aes(x = delta_align, y = delta_percent)) +
geom_point()
fus_bens_plot %>%
inner_join(. , fus2_bens_plot, by = "target_id", suffix = c("_good", "_bad")) %>%
mutate(target_id = as.character(target_id)) %>%
mutate(delta_align = (ave_pseudo_good - ave_pseudo_bad)^2) %>%
mutate(delta_percent = (percent_good - percent_bad)^2) %>%
select(target_id, delta_align, delta_percent) %>%
ggplot(aes(x = delta_align, y = delta_percent)) +
geom_point()
fus_bens_plot %>%
inner_join(. , fus2_bens_plot, by = "target_id", suffix = c("_good", "_bad")) %>%
mutate(target_id = as.character(target_id)) %>%
mutate(delta_align = (ave_pseudo_good - ave_pseudo_bad)^2) %>%
mutate(delta_percent = (percent_good - percent_bad)^2) %>%
select(target_id, delta_align, delta_percent) %>%
ggplot(aes(x = delta_align, y = delta_percent)) +
geom_point() +
geom_point(data = test %>% filter(target_id == "ENST00000361899.2"),  color= "red")
fus_bens_plot %>%
inner_join(. , fus2_bens_plot, by = "target_id", suffix = c("_good", "_bad")) %>%
mutate(target_id = as.character(target_id)) %>%
mutate(delta_align = (ave_pseudo_good - ave_pseudo_bad)^2) %>%
mutate(delta_percent = (percent_good - percent_bad)^2) %>%
select(target_id, delta_align, delta_percent) %>%
ggplot(aes(x = delta_align, y = delta_percent)) +
geom_point() +
geom_point(data = fus_bens_plot %>% filter(target_id == "ENST00000361899.2"),  color= "red")
fus_bens_plot %>%
inner_join(. , fus2_bens_plot, by = "target_id", suffix = c("_good", "_bad")) %>%
mutate(target_id = as.character(target_id)) %>%
mutate(delta_align = (ave_pseudo_good - ave_pseudo_bad)^2) %>%
mutate(delta_percent = (percent_good - percent_bad)^2) %>%
select(target_id, delta_align, delta_percent) %>%
ggplot(aes(x = delta_align, y = delta_percent)) +
geom_point()
ool17_bens_plot %>%
inner_join(. , ool18_bens_plot, by = "target_id", suffix = c("_good", "_bad")) %>%
mutate(target_id = as.character(target_id)) %>%
mutate(delta_align = (ave_pseudo_good - ave_pseudo_bad)^2) %>%
mutate(delta_percent = (percent_good - percent_bad)^2) %>%
select(target_id, delta_align, delta_percent) %>%
ggplot(aes(x = delta_align, y = delta_percent)) +
geom_point()
fus_bens_plot %>%
inner_join(. , ool18_bens_plot, by = "target_id", suffix = c("_good", "_bad")) %>%
mutate(target_id = as.character(target_id)) %>%
mutate(delta_align = (ave_pseudo_good - ave_pseudo_bad)^2) %>%
mutate(delta_percent = (percent_good - percent_bad)^2) %>%
select(target_id, delta_align, delta_percent) %>%
ggplot(aes(x = delta_align, y = delta_percent)) +
geom_point()
fus_bens_plot %>%
inner_join(. , ool12_bens_plot, by = "target_id", suffix = c("_good", "_bad")) %>%
mutate(target_id = as.character(target_id)) %>%
mutate(delta_align = (ave_pseudo_good - ave_pseudo_bad)^2) %>%
mutate(delta_percent = (percent_good - percent_bad)^2) %>%
select(target_id, delta_align, delta_percent) %>%
ggplot(aes(x = delta_align, y = delta_percent)) +
geom_point()
fus_bens_plot %>%
inner_join(. , dhh1_bens_plot, by = "target_id", suffix = c("_good", "_bad")) %>%
mutate(target_id = as.character(target_id)) %>%
mutate(delta_align = (ave_pseudo_good - ave_pseudo_bad)^2) %>%
mutate(delta_percent = (percent_good - percent_bad)^2) %>%
select(target_id, delta_align, delta_percent) %>%
ggplot(aes(x = delta_align, y = delta_percent)) +
geom_point()
fus_bens_plot %>%
inner_join(. , dhh1_bens_plot, by = "target_id", suffix = c("_good", "_bad")) %>%
mutate(target_id = as.character(target_id)) %>%
mutate(delta_align = (ave_pseudo_good - ave_pseudo_bad)^1) %>%
mutate(delta_percent = (percent_good - percent_bad)^1) %>%
select(target_id, delta_align, delta_percent) %>%
ggplot(aes(x = delta_align, y = delta_percent)) +
geom_point()
fus_bens_plot %>%
inner_join(. , ool18_bens_plot, by = "target_id", suffix = c("_good", "_bad")) %>%
mutate(target_id = as.character(target_id)) %>%
mutate(delta_align = (ave_pseudo_good - ave_pseudo_bad)^1) %>%
mutate(delta_percent = (percent_good - percent_bad)^1) %>%
select(target_id, delta_align, delta_percent) %>%
ggplot(aes(x = delta_align, y = delta_percent)) +
geom_point()
fus_bens_plot %>%
inner_join(. , ool18_bens_plot, by = "target_id", suffix = c("_good", "_bad")) %>%
mutate(target_id = as.character(target_id)) %>%
mutate(delta_align = (ave_pseudo_good - ave_pseudo_bad)^1) %>%
mutate(delta_percent = (percent_good - percent_bad)^1) %>%
select(target_id, delta_align, delta_percent) %>%
ggplot(aes(x = delta_align, y = delta_percent)) +
geom_point() +
geom_density_2d()
fus_bens_plot %>%
inner_join(. , ool12_bens_plot, by = "target_id", suffix = c("_good", "_bad")) %>%
mutate(target_id = as.character(target_id)) %>%
mutate(delta_align = (ave_pseudo_good - ave_pseudo_bad)^1) %>%
mutate(delta_percent = (percent_good - percent_bad)^1) %>%
select(target_id, delta_align, delta_percent) %>%
ggplot(aes(x = delta_align, y = delta_percent)) +
geom_point() +
geom_density_2d()
fus_bens_plot %>%
inner_join(. , fus2_bens_plot, by = "target_id", suffix = c("_good", "_bad")) %>%
mutate(target_id = as.character(target_id)) %>%
mutate(delta_align = (ave_pseudo_good - ave_pseudo_bad)^1) %>%
mutate(delta_percent = (percent_good - percent_bad)^1) %>%
select(target_id, delta_align, delta_percent) %>%
ggplot(aes(x = delta_align, y = delta_percent)) +
geom_point() +
geom_density_2d()
fus_bens_plot %>%
inner_join(. , ool12_bens_plot, by = "target_id", suffix = c("_good", "_bad")) %>%
mutate(target_id = as.character(target_id)) %>%
mutate(delta_align = (ave_pseudo_good - ave_pseudo_bad)^1) %>%
mutate(delta_percent = (percent_good - percent_bad)^1) %>%
select(target_id, delta_align, delta_percent)
fus_bens_plot %>%
inner_join(. , ool12_bens_plot, by = "target_id", suffix = c("_good", "_bad")) %>%
mutate(target_id = as.character(target_id)) %>%
mutate(delta_align = (ave_pseudo_good - ave_pseudo_bad)^1) %>%
mutate(delta_percent = (percent_good - percent_bad)^1) %>%
select(target_id, delta_align, delta_percent) %>%
ggplot(aes(x = delta_align, y = delta_percent)) +
geom_point() +
geom_density_2d() +
geom_hline(aes(yintercept = mean(delta_percent)), color = "red")
fus_bens_plot %>%
inner_join(. , ool12_bens_plot, by = "target_id", suffix = c("_good", "_bad")) %>%
mutate(target_id = as.character(target_id)) %>%
mutate(delta_align = (ave_pseudo_good - ave_pseudo_bad)^1) %>%
mutate(delta_percent = (percent_good - percent_bad)^1) %>%
select(target_id, delta_align, delta_percent) %>%
ggplot(aes(x = delta_align, y = delta_percent)) +
geom_point() +
geom_density_2d() +
geom_hline(aes(yintercept = mean(delta_percent)), color = "red") +
geom_vline(aes(xintercept = mean(delta_align)), color = "red")
fus_bens_plot %>%
inner_join(. , ool18_bens_plot, by = "target_id", suffix = c("_good", "_bad")) %>%
mutate(target_id = as.character(target_id)) %>%
mutate(delta_align = (ave_pseudo_good - ave_pseudo_bad)^1) %>%
mutate(delta_percent = (percent_good - percent_bad)^1) %>%
select(target_id, delta_align, delta_percent) %>%
ggplot(aes(x = delta_align, y = delta_percent)) +
geom_point() +
geom_density_2d() +
geom_hline(aes(yintercept = mean(delta_percent)), color = "red") +
geom_vline(aes(xintercept = mean(delta_align)), color = "red")
dhh1_bens_plot %>%
inner_join(. , ool12_bens_plot, by = "target_id", suffix = c("_good", "_bad")) %>%
mutate(target_id = as.character(target_id)) %>%
mutate(delta_align = (ave_pseudo_good - ave_pseudo_bad)^1) %>%
mutate(delta_percent = (percent_good - percent_bad)^1) %>%
select(target_id, delta_align, delta_percent) %>%
ggplot(aes(x = delta_align, y = delta_percent)) +
geom_point() +
geom_density_2d() +
geom_hline(aes(yintercept = mean(delta_percent)), color = "red") +
geom_vline(aes(xintercept = mean(delta_align)), color = "red")
dhh1_bens_plot %>%
inner_join(. , ool12_bens_plot, by = "target_id", suffix = c("_good", "_bad")) %>%
mutate(target_id = as.character(target_id)) %>%
mutate(delta_align = (ave_pseudo_good - ave_pseudo_bad)^2) %>%
mutate(delta_percent = (percent_good - percent_bad)^2) %>%
select(target_id, delta_align, delta_percent) %>%
ggplot(aes(x = delta_align, y = delta_percent)) +
geom_point() +
geom_density_2d() +
geom_hline(aes(yintercept = mean(delta_percent)), color = "red") +
geom_vline(aes(xintercept = mean(delta_align)), color = "red")
dhh1_bens_plot %>%
inner_join(. , fus_bens_plot, by = "target_id", suffix = c("_good", "_bad")) %>%
mutate(target_id = as.character(target_id)) %>%
mutate(delta_align = (ave_pseudo_good - ave_pseudo_bad)^2) %>%
mutate(delta_percent = (percent_good - percent_bad)^2) %>%
select(target_id, delta_align, delta_percent) %>%
ggplot(aes(x = delta_align, y = delta_percent)) +
geom_point() +
geom_density_2d() +
geom_hline(aes(yintercept = mean(delta_percent)), color = "red") +
geom_vline(aes(xintercept = mean(delta_align)), color = "red")
dhh1_bens_plot %>%
inner_join(. , fus_bens_plot, by = "target_id", suffix = c("_good", "_bad")) %>%
mutate(target_id = as.character(target_id)) %>%
mutate(delta_align = (ave_pseudo_good - ave_pseudo_bad)^1) %>%
mutate(delta_percent = (percent_good - percent_bad)^1) %>%
select(target_id, delta_align, delta_percent) %>%
ggplot(aes(x = delta_align, y = delta_percent)) +
geom_point() +
geom_density_2d() +
geom_hline(aes(yintercept = mean(delta_percent)), color = "red") +
geom_vline(aes(xintercept = mean(delta_align)), color = "red")
# Setup
library(tidyverse)
library(factoextra)
library(cowplot)
# Load seq data
master <- readRDS(file = "/Users/damian_wollny/PD/Data/OoL/19.1_Draft_2/Generate_input/draft2_input.RDS")
master %>% head()
master %>% filter(experiment == "ool17" | "ool18") %>% group_by(cell_id) %>% summarise(count = n())
str(master)
levels(as.factor(master$experiment))
master %>% filter(experiment == "ool17" | experiment == "ool18") %>% group_by(cell_id) %>% summarise(count = n())
master %>% filter(experiment == "ool17" | experiment == "ool18") %>% group_by(cell_id) %>% summarise(count = n()) %>% pull(cell_id)
master %>% filter(experiment == "ool17" | experiment == "ool18") %>% group_by(cell_id) %>% summarise(count = n()) %>% pull(cell_id) %>% length()
# Chunk 1: setup
knitr::opts_chunk$set(echo = T, warning = FALSE, message = FALSE)
#options(width = 12)
# Chunk 2
# Setup
library(tidyverse)
library(Rmpfr)
library(foreach)
library(data.table)
library(flowCore)
library(cowplot)
theme_set(theme_classic(base_size=24))
setwd(dir = "~/PD/Data/OoL/33_Draft_3/_s_fig3/")
# Chunk 3
# load and format input
input <- read.csv("/Users/damian_wollny/PD/Data/OoL/19.1_Draft_2/_Fig_3/_motif_distance_analysis/parsed_meme_output.csv", colClasses = c("motif_enrichment" = "character"))
input$motif_enrichment <- as.numeric(log(mpfr(input$motif_enrichment)))
input$motif_enrichment <- input$motif_enrichment*-1
input$motif_idx <- as.integer(input$motif)
# function from Ben Vernot to get combination of clostest motifs and their distances
# needs data.table as input
get_combs <- function(dt) {
res2 <- foreach (idx = 1:nrow(dt), .combine = rbind) %do% {
t1 <- dt[idx, transcript]
p1 <- dt[idx, start]
m1 <- dt[idx, motif]
#cat(idx, t1, m1, '\n')
dt.tmp <- dt[transcript == t1 & motif != m1]
if (nrow(dt.tmp) == 0) return(data.table())
dt.tmp[, my.dist := abs(start - p1)]
dt.tmp <- dt.tmp[my.dist == min(my.dist)]
data.table(idx, t1, m1, m2 = dt.tmp[, motif], my.dist = dt.tmp[, my.dist])
}
res2
}
# dplyr::filter out only motif1 and motif2
input$motif <- as.character(input$motif)
dt <- input %>% dplyr::filter(motif == "ATYCTCCYGCCTCAGCCTCCCRARKWGCTGGGATTACAGGCGTGMGCCAC" |
motif == "GTGGCTCAYGCCTGTAATCCCAGCWMYTTGGGAGGCYGAGGCRGGAGRAT")
# sanity check
levels(as.factor(dt$motif))
# get motif distances
dist_dt <- get_combs(as.data.table(dt))
# plot distances
fig_s3a <- dist_dt %>%
ggplot(aes(my.dist)) +
geom_histogram(color = "white") +
labs(x = "Shortest distance between Motif1 & Motif2")
plot(fig_s3a)
ggsave(fig_s3a, file="./fig3a.pdf", width = 8, height = 6)
# Chunk 4
dir <- "/Users/damian_wollny/PD/Data/OoL/18.2_integrative_analysis/_6_structure_analysis"
# import parsed RNAfold output for each transcript pool
enriched <- read.csv(file = paste(dir, "/output/enriched_clean.txt", sep = ""))
random <- read.csv(file = paste(dir, "/output/random_clean.txt", sep = ""))
rna_fold_results <- bind_rows(enriched, random) %>%
dplyr::rename(target_id = "transcript_id")
master <- readRDS(file = "/Users/damian_wollny/PD/Data/OoL/19.1_Draft_2/Generate_input/draft2_input.RDS")
rna_fold_results2 <- master %>%
inner_join(.,rna_fold_results, by = "target_id") %>%
dplyr::filter(experiment == "ool12") %>%
dplyr::select(c(target_id, log2_tpm,free_energy,length,transcript_pool)) %>%
mutate(norm_free_energy = free_energy/length)
fig_s3b <- ggplot(data = rna_fold_results2, aes(norm_free_energy))+
geom_density(aes(colour = transcript_pool)) +
scale_color_manual(values = c("#9E0142", "darkgrey"),
labels = c("Enriched transcripts", "Random transcripts")) +
xlab("free energy [kcal/mol] / length [bp]") +
theme(legend.title = element_blank(), legend.position = "top")
plot(fig_s3b)
ggsave(fig_s3b, file="./fig3b.pdf", width = 7, height = 6)
# Chunk 5
### Motif ###
#############
motif_30 <- read.FCS(filename = "/Users/damian_wollny/PD/Data/OoL/21_Synthetic_oligo_analysis/20190731_FACS/20190731 Origin of life - Analyses_motif_30min_015.fcs")
motif_60 <- read.FCS(filename = "/Users/damian_wollny/PD/Data/OoL/21_Synthetic_oligo_analysis/20190731_FACS/20190731 Origin of life - Analyses_motif_60min_016.fcs")
rc_motif_30 <- read.FCS(filename = "/Users/damian_wollny/PD/Data/OoL/21_Synthetic_oligo_analysis/20190731_FACS/20190731 Origin of life - Analyses_RC_motif_30min_017.fcs")
rc_motif_60 <- read.FCS(filename = "/Users/damian_wollny/PD/Data/OoL/21_Synthetic_oligo_analysis/20190731_FACS/20190731 Origin of life - Analyses_RC_motif_60min_018.fcs")
ds_motif_30 <- read.FCS(filename = "/Users/damian_wollny/PD/Data/OoL/21_Synthetic_oligo_analysis/20190731_FACS/20190731 Origin of life - Analyses_Motif^2_30min_023.fcs")
ds_motif_60 <- read.FCS(filename = "/Users/damian_wollny/PD/Data/OoL/21_Synthetic_oligo_analysis/20190731_FACS/20190731 Origin of life - Analyses_Motif^2_60min_024.fcs")
motif_60 <- as.data.frame(motif_60@exprs) %>%
mutate(group = "motif") %>%
mutate(oligo = "Motif1") %>%
mutate(ds = "no") %>%
mutate(time = "60")
rc_motif_60 <- as.data.frame(rc_motif_60@exprs) %>%
mutate(group = "motif") %>%
mutate(oligo = "RC of Motif1\n(Motif2)") %>%
mutate(ds = "no") %>%
mutate(time = "60")
ds_motif_60 <- as.data.frame(ds_motif_60@exprs) %>%
mutate(group = "motif") %>%
mutate(oligo = "Motif1 + RC") %>%
mutate(ds = "yes") %>%
mutate(time = "60")
# -------------------------------------------------------------------------------------------------------------------
### Scrambled motif ###
#######################
scrambled_30 <- read.FCS(filename = "/Users/damian_wollny/PD/Data/OoL/21_Synthetic_oligo_analysis/20190731_FACS/20190731 Origin of life - Analyses_SCR_30min_011.fcs")
scrambled_60 <- read.FCS(filename = "/Users/damian_wollny/PD/Data/OoL/21_Synthetic_oligo_analysis/20190731_FACS/20190731 Origin of life - Analyses_SCR_60min_012.fcs")
rc_scrambled_30 <- read.FCS(filename = "/Users/damian_wollny/PD/Data/OoL/21_Synthetic_oligo_analysis/20190731_FACS/20190731 Origin of life - Analyses_RC_SCR_30min_013.fcs")
rc_scrambled_60 <- read.FCS(filename = "/Users/damian_wollny/PD/Data/OoL/21_Synthetic_oligo_analysis/20190731_FACS/20190731 Origin of life - Analyses_RC_SCR_60min_014.fcs")
ds_scrambled_30 <- read.FCS(filename = "/Users/damian_wollny/PD/Data/OoL/21_Synthetic_oligo_analysis/20190731_FACS/20190731 Origin of life - Analyses_SCR^2_30min_021.fcs")
ds_scrambled_60 <- read.FCS(filename = "/Users/damian_wollny/PD/Data/OoL/21_Synthetic_oligo_analysis/20190731_FACS/20190731 Origin of life - Analyses_SCR^2_60min_022.fcs")
scrambled_60 <- as.data.frame(scrambled_60@exprs) %>%
mutate(group = "scrambled") %>%
mutate(oligo = "Scr Motif1") %>%
mutate(ds = "no") %>%
mutate(time = "60")
rc_scrambled_60 <- as.data.frame(rc_scrambled_60@exprs) %>%
mutate(group = "scrambled") %>%
mutate(oligo = "RC of Scr Motif1") %>%
mutate(ds = "no") %>%
mutate(time = "60")
ds_scrambled_60 <- as.data.frame(ds_scrambled_60@exprs) %>%
mutate(group = "scrambled") %>%
mutate(oligo = "Scr Motif1 + RC") %>%
mutate(ds = "yes") %>%
mutate(time = "60")
### Generate master df ###
##########################
ool21_master <- bind_rows(motif_60, rc_motif_60, ds_motif_60, scrambled_60, rc_scrambled_60, ds_scrambled_60)
# convert 'group' col to factor and change level for facet labels
ool21_master$group <- as.factor(ool21_master$group)
levels(ool21_master$group) <- c("Motifs", "Scrambled")
fig_s3c <- ool21_master %>%
mutate(norm_fitc = `FITC-A`/`FSC-A`) %>%
dplyr::filter(time == 60) %>%
ggplot(aes(x =reorder(oligo, -norm_fitc, FUN = median), y = norm_fitc, colour = ds)) +
geom_boxplot() +
facet_grid(. ~ group,scales = "free_x") +
scale_color_manual(values = c("#9E0142", "darkgrey"),
breaks = c("yes", "no"),
labels = c("Double stranded", "Single stranded")) +
geom_hline(aes(yintercept= median(ool21_master %>%
dplyr::filter(group == "Motifs", ds == "yes") %>%
mutate(norm_fitc = `FITC-A`/`FSC-A`) %>%
pull(norm_fitc))), colour="black", linetype="dashed") +
labs(y = "normalized FAM signal") +
theme(legend.title = element_blank(),
axis.text.x = element_text(angle = 45, hjust = 1),
axis.title.x = element_blank(),
legend.position = "top")
plot(fig_s3c)
ggsave(fig_s3c, file="./fig3c.pdf", width = 9, height = 7)
ool21_master %>%
mutate(norm_fitc = `FITC-A`/`FSC-A`) %>%
dplyr::filter(time == 60)
ool21_master %>%
mutate(norm_fitc = `FITC-A`/`FSC-A`) %>%
dplyr::filter(time == 60) %>% nrow()
ool21_master %>%
mutate(norm_fitc = `FITC-A`/`FSC-A`) %>%
dplyr::filter(time == 60) %>% group_by(oligo) %>% summarise(count = n())
