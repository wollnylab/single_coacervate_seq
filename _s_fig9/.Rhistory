Protocol.REF.1 = "Protocol 2",
Protocol.REF.2 = "Protocol 3",
Comment.LIBRARY_LAYOUT. = "PAIRED",
Comment.LIBRARY_SELECTION. = "Oligo-dT",
Comment.LIBRARY_SOURCE. = "TRANSCRIPTOMIC",
Comment.LIBRARY_STRAND. = "not applicable",
Comment.LIBRARY_STRATEGY. = "OTHER",
Protocol.REF.3 = "Protocol 4",
Performer = "Max Planck Institute for Evolutionary Anthropology",
Technology.Type = "sequencing assay",
#Source.Name = paste("Sample", gl(((nrow(test)-1)/2), 2), sep = " "),
#Extract.Name = Source.Name,
#Assay.Name = Source.Name,
Factor.Value.compound. = case_when(
str_detect(Array.Data.File, "ool12|ool9") ~ "CM-Dex:pLys",
str_detect(Array.Data.File, "OOL17|OOL18") ~ "CM-Dex:PDDA",
str_detect(Array.Data.File, "OOL22") ~ "FUS",
str_detect(Array.Data.File, "OOL24") ~ "Dhh1"
)
)
test2
gl(((nrow(test)-1)/2) %>% length =
gl(((nrow(test)-1)/2) %>% length()
gl(((nrow(test)-1)/2),2) %>% length()
gl(((nrow(test)-1)/2)
d
gl((nrow(test)-1)/2)
gl(((nrow(test)-1)/2), 2)
gl(((nrow(test)-1)/2), 2) %>% length()
nrow(test)
gl(((nrow(test)/2), 2) %>% length()
gl(((nrow(test))/2), 2) %>% length()
test2 <- test %>%
mutate(Characteristics.organism. = "Homo sapiens",
Characteristics.developmental.stage. = "adult",
Characteristics.cell.type. = "induced pluripotent stem cell",
Characteristics.cell.line. = "409B2",
Material.Type = "RNA",
Material.Type.1 = "RNA",
Protocol.REF = "Protocol 1",
Protocol.REF.1 = "Protocol 2",
Protocol.REF.2 = "Protocol 3",
Comment.LIBRARY_LAYOUT. = "PAIRED",
Comment.LIBRARY_SELECTION. = "Oligo-dT",
Comment.LIBRARY_SOURCE. = "TRANSCRIPTOMIC",
Comment.LIBRARY_STRAND. = "not applicable",
Comment.LIBRARY_STRATEGY. = "OTHER",
Protocol.REF.3 = "Protocol 4",
Performer = "Max Planck Institute for Evolutionary Anthropology",
Technology.Type = "sequencing assay",
Source.Name = paste("Sample", gl((nrow(test)/2), 2), sep = " "),
Extract.Name = Source.Name,
Assay.Name = Source.Name,
Factor.Value.compound. = case_when(
str_detect(Array.Data.File, "ool12|ool9") ~ "CM-Dex:pLys",
str_detect(Array.Data.File, "OOL17|OOL18") ~ "CM-Dex:PDDA",
str_detect(Array.Data.File, "OOL22") ~ "FUS",
str_detect(Array.Data.File, "OOL24") ~ "Dhh1"
)
)
test2
test2 %>% tail() %>% select(Source.Name, Assay.Name, Array.Data.File, Factor.Value.compound.)
test2 %>% View()
test2 %>% select(Source.Name, Assay.Name, Array.Data.File, Factor.Value.compound.) %>% View()
test %>% filter(Array.Data.File == "OOL24V2P1D1")
test %>% filter(Comment.MD5. == NA)
test %>% filter(Comment.MD5. == "")
test %>% filter(Comment.MD5. == "") %>% select(Array.Data.File)
test %>% mutate(new = n()) %>% filter(Comment.MD5. == "") %>% select(Array.Data.File, new)
test <- read.csv(file = "/Users/damian_wollny/Dropbox/coacervate_manuscript/_nat_chem/_submitted/_revised/_annotare/submission12441_annotare_v3.sdrf.dw2.txt", sep = "\t") %>%
as.tbl()
test2 <- test %>%
mutate(Characteristics.organism. = "Homo sapiens",
Characteristics.developmental.stage. = "adult",
Characteristics.cell.type. = "induced pluripotent stem cell",
Characteristics.cell.line. = "409B2",
Material.Type = "RNA",
Material.Type.1 = "RNA",
Protocol.REF = "Protocol 1",
Protocol.REF.1 = "Protocol 2",
Protocol.REF.2 = "Protocol 3",
Comment.LIBRARY_LAYOUT. = "PAIRED",
Comment.LIBRARY_SELECTION. = "Oligo-dT",
Comment.LIBRARY_SOURCE. = "TRANSCRIPTOMIC",
Comment.LIBRARY_STRAND. = "not applicable",
Comment.LIBRARY_STRATEGY. = "OTHER",
Protocol.REF.3 = "Protocol 4",
Performer = "Max Planck Institute for Evolutionary Anthropology",
Technology.Type = "sequencing assay",
Source.Name = paste("Sample", gl((nrow(test)/2), 2), sep = " "),
Extract.Name = Source.Name,
Assay.Name = Source.Name,
Factor.Value.compound. = case_when(
str_detect(Array.Data.File, "ool12|ool9") ~ "CM-Dex:pLys",
str_detect(Array.Data.File, "OOL17|OOL18") ~ "CM-Dex:PDDA",
str_detect(Array.Data.File, "OOL22") ~ "FUS",
str_detect(Array.Data.File, "OOL24") ~ "Dhh1"
)
)
test2
test2 %>% tail(
)
test2 %>% filter(Comment.MD5. == "")
test2 %>% filter(Comment.MD5. == "") %>% select(Souece.Name, Array.Data.File, new)
test2 %>% filter(Comment.MD5. == "") %>% select(Source.Name, Array.Data.File, new)
test2 %>% filter(Comment.MD5. == "")# %>% select(Source.Name, Array.Data.File, new)
test2 %>% filter(Comment.MD5. == "") %>% select(Source.Name)#, Array.Data.File, new)
test2 %>% filter(Comment.MD5. == "") %>% select(Source.Name, Array.Data.File)#, new)
test2 %>% filter(Comment.MD5. == "") %>% select(Source.Name, Array.Data.File, new)
test2 %>% filter(Comment.MD5. == "") %>% select(Source.Name, Array.Data.File, count)
View(test2)
test %>% mutate(new = n()) %>% select(Array.Data.File, new) %>% View()
test2 %>% select(Source.Name, Array.Data.File, count) %>% View()
test <- read.csv(file = "/Users/damian_wollny/Dropbox/coacervate_manuscript/_nat_chem/_submitted/_revised/_annotare/submission12441_annotare_v3.sdrf.dw2.txt", sep = "\t") %>%
as.tbl()
test2 <- test %>%
mutate(Characteristics.organism. = "Homo sapiens",
Characteristics.developmental.stage. = "adult",
Characteristics.cell.type. = "induced pluripotent stem cell",
Characteristics.cell.line. = "409B2",
Material.Type = "RNA",
Material.Type.1 = "RNA",
Protocol.REF = "Protocol 1",
Protocol.REF.1 = "Protocol 2",
Protocol.REF.2 = "Protocol 3",
Comment.LIBRARY_LAYOUT. = "PAIRED",
Comment.LIBRARY_SELECTION. = "Oligo-dT",
Comment.LIBRARY_SOURCE. = "TRANSCRIPTOMIC",
Comment.LIBRARY_STRAND. = "not applicable",
Comment.LIBRARY_STRATEGY. = "OTHER",
Protocol.REF.3 = "Protocol 4",
Performer = "Max Planck Institute for Evolutionary Anthropology",
Technology.Type = "sequencing assay",
Source.Name = paste("Sample", gl((nrow(test)/2), 2), sep = " "),
Extract.Name = Source.Name,
Assay.Name = Source.Name,
Factor.Value.compound. = case_when(
str_detect(Array.Data.File, "ool12|ool9") ~ "CM-Dex:pLys",
str_detect(Array.Data.File, "OOL17|OOL18") ~ "CM-Dex:PDDA",
str_detect(Array.Data.File, "OOL22") ~ "FUS",
str_detect(Array.Data.File, "OOL24") ~ "Dhh1"
)
)
test2
test2 %>% tail() %>% select(count, Source.Name, Array.Data.File, Factor.Value.compound.)
test2 <- test %>%
mutate(Characteristics.organism. = "Homo sapiens",
Characteristics.developmental.stage. = "adult",
Characteristics.cell.type. = "induced pluripotent stem cell",
Characteristics.cell.line. = "409B2",
Material.Type = "RNA",
Material.Type.1 = "RNA",
Protocol.REF = "Protocol 1",
Protocol.REF.1 = "Protocol 2",
Protocol.REF.2 = "Protocol 3",
Comment.LIBRARY_LAYOUT. = "PAIRED",
Comment.LIBRARY_SELECTION. = "Oligo-dT",
Comment.LIBRARY_SOURCE. = "TRANSCRIPTOMIC",
Comment.LIBRARY_STRAND. = "not applicable",
Comment.LIBRARY_STRATEGY. = "OTHER",
Protocol.REF.3 = "Protocol 4",
Performer = "Max Planck Institute for Evolutionary Anthropology",
Technology.Type = "sequencing assay",
Source.Name = paste("Sample", gl((nrow(test)/2), 2), sep = " "),
Extract.Name = Source.Name,
Assay.Name = Source.Name,
Factor.Value.compound. = case_when(
str_detect(Array.Data.File, "ool12|ool9") ~ "CM-Dex:pLys",
str_detect(Array.Data.File, "OOL17|OOL18") ~ "CM-Dex:PDDA",
str_detect(Array.Data.File, "OOL22") ~ "FUS",
str_detect(Array.Data.File, "OOL24") ~ "Dhh1"
) %>%
select(-count)
)
test2 <- test %>%
mutate(Characteristics.organism. = "Homo sapiens",
Characteristics.developmental.stage. = "adult",
Characteristics.cell.type. = "induced pluripotent stem cell",
Characteristics.cell.line. = "409B2",
Material.Type = "RNA",
Material.Type.1 = "RNA",
Protocol.REF = "Protocol 1",
Protocol.REF.1 = "Protocol 2",
Protocol.REF.2 = "Protocol 3",
Comment.LIBRARY_LAYOUT. = "PAIRED",
Comment.LIBRARY_SELECTION. = "Oligo-dT",
Comment.LIBRARY_SOURCE. = "TRANSCRIPTOMIC",
Comment.LIBRARY_STRAND. = "not applicable",
Comment.LIBRARY_STRATEGY. = "OTHER",
Protocol.REF.3 = "Protocol 4",
Performer = "Max Planck Institute for Evolutionary Anthropology",
Technology.Type = "sequencing assay",
Source.Name = paste("Sample", gl((nrow(test)/2), 2), sep = " "),
Extract.Name = Source.Name,
Assay.Name = Source.Name,
Factor.Value.compound. = case_when(
str_detect(Array.Data.File, "ool12|ool9") ~ "CM-Dex:pLys",
str_detect(Array.Data.File, "OOL17|OOL18") ~ "CM-Dex:PDDA",
str_detect(Array.Data.File, "OOL22") ~ "FUS",
str_detect(Array.Data.File, "OOL24") ~ "Dhh1"
) %>%
) %>%
select(-count)
test2 <- test %>%
select(-count) %>%
mutate(Characteristics.organism. = "Homo sapiens",
Characteristics.developmental.stage. = "adult",
Characteristics.cell.type. = "induced pluripotent stem cell",
Characteristics.cell.line. = "409B2",
Material.Type = "RNA",
Material.Type.1 = "RNA",
Protocol.REF = "Protocol 1",
Protocol.REF.1 = "Protocol 2",
Protocol.REF.2 = "Protocol 3",
Comment.LIBRARY_LAYOUT. = "PAIRED",
Comment.LIBRARY_SELECTION. = "Oligo-dT",
Comment.LIBRARY_SOURCE. = "TRANSCRIPTOMIC",
Comment.LIBRARY_STRAND. = "not applicable",
Comment.LIBRARY_STRATEGY. = "OTHER",
Protocol.REF.3 = "Protocol 4",
Performer = "Max Planck Institute for Evolutionary Anthropology",
Technology.Type = "sequencing assay",
Source.Name = paste("Sample", gl((nrow(test)/2), 2), sep = " "),
Extract.Name = Source.Name,
Assay.Name = Source.Name,
Factor.Value.compound. = case_when(
str_detect(Array.Data.File, "ool12|ool9") ~ "CM-Dex:pLys",
str_detect(Array.Data.File, "OOL17|OOL18") ~ "CM-Dex:PDDA",
str_detect(Array.Data.File, "OOL22") ~ "FUS",
str_detect(Array.Data.File, "OOL24") ~ "Dhh1"
) %>%
)
test2 <- test %>%
mutate(Characteristics.organism. = "Homo sapiens",
Characteristics.developmental.stage. = "adult",
Characteristics.cell.type. = "induced pluripotent stem cell",
Characteristics.cell.line. = "409B2",
Material.Type = "RNA",
Material.Type.1 = "RNA",
Protocol.REF = "Protocol 1",
Protocol.REF.1 = "Protocol 2",
Protocol.REF.2 = "Protocol 3",
Comment.LIBRARY_LAYOUT. = "PAIRED",
Comment.LIBRARY_SELECTION. = "Oligo-dT",
Comment.LIBRARY_SOURCE. = "TRANSCRIPTOMIC",
Comment.LIBRARY_STRAND. = "not applicable",
Comment.LIBRARY_STRATEGY. = "OTHER",
Protocol.REF.3 = "Protocol 4",
Performer = "Max Planck Institute for Evolutionary Anthropology",
Technology.Type = "sequencing assay",
Source.Name = paste("Sample", gl((nrow(test)/2), 2), sep = " "),
Extract.Name = Source.Name,
Assay.Name = Source.Name,
Factor.Value.compound. = case_when(
str_detect(Array.Data.File, "ool12|ool9") ~ "CM-Dex:pLys",
str_detect(Array.Data.File, "OOL17|OOL18") ~ "CM-Dex:PDDA",
str_detect(Array.Data.File, "OOL22") ~ "FUS",
str_detect(Array.Data.File, "OOL24") ~ "Dhh1"
) %>%
)
test2 <- test %>%
select(-count) %>%
mutate(Characteristics.organism. = "Homo sapiens",
Characteristics.developmental.stage. = "adult",
Characteristics.cell.type. = "induced pluripotent stem cell",
Characteristics.cell.line. = "409B2",
Material.Type = "RNA",
Material.Type.1 = "RNA",
Protocol.REF = "Protocol 1",
Protocol.REF.1 = "Protocol 2",
Protocol.REF.2 = "Protocol 3",
Comment.LIBRARY_LAYOUT. = "PAIRED",
Comment.LIBRARY_SELECTION. = "Oligo-dT",
Comment.LIBRARY_SOURCE. = "TRANSCRIPTOMIC",
Comment.LIBRARY_STRAND. = "not applicable",
Comment.LIBRARY_STRATEGY. = "OTHER",
Protocol.REF.3 = "Protocol 4",
Performer = "Max Planck Institute for Evolutionary Anthropology",
Technology.Type = "sequencing assay",
Source.Name = paste("Sample", gl((nrow(test)/2), 2), sep = " "),
Extract.Name = Source.Name,
Assay.Name = Source.Name,
Factor.Value.compound. = case_when(
str_detect(Array.Data.File, "ool12|ool9") ~ "CM-Dex:pLys",
str_detect(Array.Data.File, "OOL17|OOL18") ~ "CM-Dex:PDDA",
str_detect(Array.Data.File, "OOL22") ~ "FUS",
str_detect(Array.Data.File, "OOL24") ~ "Dhh1"
)
)
test2
write.csv(test2, file = "/Users/damian_wollny/Dropbox/coacervate_manuscript/_nat_chem/_submitted/_revised/_annotare/submission12441_annotare_v3.sdrf.dw3.txt")
4*2*4
4*2*5
13200+(5600*2)
seq(10,1)
seq(110,1)
seq(110:120,1)
seq(c(110:120),1)
seq(110,1.2)
seq(110.1,1.2)
?seq
seq(110,150,.1)
seq(110,150,2)
seq(110,150,2^2)
qexp((110:125)/100)
?qexp
0.0001 * 6^(0:10)
110 * 2^(0:10)
110 * 2^(0.1:1)
110 * 2^(1:3)
110^(1:10)
110^(.1:1)
110^(0.1:0.9)
110^(0.9)
110^(seq(1:2, .1))
seq(1:2, .1)
seq(1,2, .1)
110^(seq(1,2, .1))
110^(seq(1,1.1, .01))
110^(seq(1,1.1, .001))
110^(seq(1,1.01, .01))
110^(seq(1,1.1, .001))
110^(seq(1,1.1, .008))
110^(seq(1,1.1, .005))
110^1.1
110^1.1
110^1.2
110^1.15
110^1.16
110^1.17
110^1.18
110^(seq(1,1.8, .005))
110^(seq(1,1.8, .05))
110^(seq(1,1.1, .005))
110^(seq(1,1.1, .006))
110^(seq(1,1.1, .007))
110^(seq(1,1.1, .003))
110^(seq(1,1.15, .003))
6^(0:10)
2^(0:10)
2^(seq(1,2, 0.1))
110*2^(seq(1,2, 0.1))
110*2^(seq(1,2, 0.1))/2
6/11
110*2^(seq(1,2.1, 0.1))/2
110*2^(seq(1,2.2, 0.1))/2
brewer.pal(n = 11, name = "Spectral")
library(RColorBrewer)
brewer.pal(n = 11, name = "Spectral")
brewer.pal(n = 20, name = "Spectral")
brewer.pal(n = 20, name = "YlGnBu")
brewer.pal(n = 9, name = "YlGnBu")
umsatz <- read.csv(file = "/Users/damian_wollny/Documents/FINANZEN/Umsatzanzeige_DE26500105175419159643_20220131.csv") %>% as.tbl()
umsatz <- read.csv(file = "/Users/damian_wollny/Documents/FINANZEN/Umsatzanzeige_DE26500105175419159643_20220131.csv", sep = "\t") %>% as.tbl()
umsatz
umsatz <- read.csv(file = "/Users/damian_wollny/Documents/FINANZEN/Umsatzanzeige_DE26500105175419159643_20220131.csv", sep = ";") %>% as.tbl()
umsatz
View(Umsatz)
View(umsatz)
umsatz <- read.csv(file = "/Users/damian_wollny/Documents/FINANZEN/Umsatzanzeige_DE26500105175419159643_20220131.csv", sep = ";", skip = 13) %>% as.tbl()
umsatz <- read.csv(file = "/Users/damian_wollny/Documents/FINANZEN/Umsatzanzeige_DE26500105175419159643_20220131.csv", sep = ";", skip = 13) %>% as.tbl()
umsatz <- read.csv(file = "/Users/damian_wollny/Documents/FINANZEN/Umsatzanzeige_DE26500105175419159643_20220131.csv", sep = ";", skip = 12) %>% as.tbl()
umsatz <- read.csv(file = "/Users/damian_wollny/Documents/FINANZEN/Umsatzanzeige_DE26500105175419159643_20220131.csv", sep = ";", skip = 14) %>% as.tbl()
umsatz
umsatz <- read.csv(file = "/Users/damian_wollny/Documents/FINANZEN/Umsatzanzeige_DE26500105175419159643_20220131.csv", sep = ";", skip = 13, header = F) %>% as.tbl()
umsatz
View(umsatz)
colnames(umsatz) <- umsatz[1,]
umsatz
colnames(umsatz) <- umsatz[14,]
umsatz
colnames(umsatz) <- umsatz[13,]
umsatz
colnames(umsatz) <- umsatz[,1]
umsatz
colnames(umsatz) <- umsatz[1,]
umsatz
colnames(umsatz) <- as.character(umsatz[1,])
umsatz
as.character(umsatz[1,])
umsatz[1,]
umsatz <- read.csv(file = "/Users/damian_wollny/Documents/FINANZEN/Umsatzanzeige_DE26500105175419159643_20220131.csv", sep = ";", skip = 13, header = F)
colnames(umsatz) <- as.character(umsatz[1,])
umsatz
umsatz <- read.csv(file = "/Users/damian_wollny/Documents/FINANZEN/Umsatzanzeige_DE26500105175419159643_20220131.csv", sep = ";", skip = 13, header = F) %>% as.tbl()
umsatz
?retype
install.packages("retype")
install.packages("hablar")
library(hablar)
umsatz %>% retype()
umsatz
umsatz %>% select(-V4) %>% retype()
umsatz[1,]
as.character(umsatz[1,])
umsatz <- umsatz %>% select(-V4) %>% retype()
as.character(umsatz[1,])
umsatz <- read.csv(file = "/Users/damian_wollny/Documents/FINANZEN/Umsatzanzeige_DE26500105175419159643_20220131.csv", sep = ";", skip = 14, header = F) %>% as.tbl()
umsatz
umsatz <- umsatz %>% retype()
install.packages("janitor")
library(janitor)
update(dplyr)
# Setup
library(tidyverse)
library(Rmpfr)
library(foreach)
library(data.table)
library(flowCore)
library(cowplot)
theme_set(theme_classic(base_size=24))
# open data from image quantification
img_count <- read.csv(file = "./_scope/quantification.csv", sep = ";") %>% select(-n) %>% as.tbl()
setwd("/Users/damian_wollny/PD/Data/OoL/45_github/single_coacervate_seq/_s_fig9")
# open data from image quantification
img_count <- read.csv(file = "./_scope/quantification.csv", sep = ";") %>% select(-n) %>% as.tbl()
img_count
# open data from image quantification
img_count <- read.csv(file = "./_scope/quantification.csv", sep = ";") %>% select(-n) %>% as.tibble()
# open data from image quantification
img_count <- read.csv(file = "./_scope/quantification.csv", sep = ";") %>% select(-n) %>% as_tibble()
img_count
# plot
quant_scope_data <- img_count %>%
group_by(sample) %>%
mutate(part_coeff = ave/mean(ave[background == "yes"]),
mean_part_coef = mean(part_coeff)) %>%
ungroup() %>%
dplyr::filter(background == "no",
grepl(pattern = "PDDA.*", x = .$sample)) %>%
mutate(name = if_else(sample == "PDDA_ds_2uM", "Motif1 + RC",
if_else(sample == "PDDA_motif_2uM", "Motif1", "Motif2"))) %>%
mutate(ds = if_else(grepl(pattern = ".*_ds.*", x = .$sample), "yes", "no")) %>%
ggplot(aes(x =reorder(name, -ave, FUN = median), y = ave, colour = ds)) +
geom_boxplot() +
geom_point(size = 4, alpha = .5) +
scale_color_manual(values = c("#9E0142", "darkgrey"),
breaks = c("yes", "no"),
labels = c("Double stranded", "Single stranded")) +
labs(y = "Fluorescence Intensity [AU]", x = "") +
theme(legend.title = element_blank(),
axis.text.x = element_text(angle = 45, hjust = 1),
axis.title.x = element_blank(),
legend.position = "right")
plot(quant_scope_data)
t
# plot
quant_scope_data <- img_count %>%
group_by(sample) %>%
mutate(part_coeff = ave/mean(ave[background == "yes"]),
mean_part_coef = mean(part_coeff)) %>%
ungroup() %>%
dplyr::filter(background == "no",
grepl(pattern = "PDDA.*", x = .$sample)) %>%
#mutate(name = if_else(sample == "PDDA_ds_2uM", "Motif1 + RC",
#                      if_else(sample == "PDDA_motif_2uM", "Motif1", "Motif2"))) %>%
mutate(ds = if_else(grepl(pattern = ".*_ds.*", x = .$sample), "yes", "no")) %>%
ggplot(aes(x =reorder(sample, -ave, FUN = median), y = ave, colour = ds)) +
geom_boxplot() +
geom_point(size = 4, alpha = .5) +
scale_color_manual(values = c("#9E0142", "darkgrey"),
breaks = c("yes", "no"),
labels = c("Double stranded", "Single stranded")) +
labs(y = "Fluorescence Intensity [AU]", x = "") +
theme(legend.title = element_blank(),
axis.text.x = element_text(angle = 45, hjust = 1),
axis.title.x = element_blank(),
legend.position = "right")
plot(quant_scope_data)
# Get parsed meme data from random transcripts
enr_trans <- read.csv(file = "~/PD/Data/OoL/18.2_integrative_analysis/_1_comparison/_even_newer_meme_analysis/_ave_pdda_coac/_meme_output/resids/parsed_meme_output.csv")
# reorder factor levels according to MEME enrichment score
level_order <- c(5,9,7,10,4,8,6,2,3,1)
enr_trans$motif <- factor(enr_trans$motif,levels = levels(enr_trans$motif)[level_order])
enr_trans <- enr_trans %>% mutate(motif_rank = as.integer((enr_trans$motif)))
enr_trans
# Calculate size of the gaps between all motifs for each transcript
enr_trans_dist <- enr_trans %>%
group_by(transcript) %>%
arrange(start) %>%
mutate(dist = start - lag(start)) %>% # distance to previous motif
mutate(previous_motif = lag(motif_rank)) %>% # what is the previous motif
filter(!is.na(dist))
# New facet label names for motif_rank variables
facet.labs.r <- paste("Motif: ", enr_trans_dist$motif_rank)
names(facet.labs.r) <- c(enr_trans_dist$motif_rank)
enr_trans_dist
# New facet label names for motif_rank variables
facet.labs.r <- paste("Motif: ", enr_trans_dist$motif_rank)
enr_trans_dist$motif_rank
enr_trans_dist
enr_trans
enr_trans %>%
group_by(transcript) %>%
arrange(start) %>%
mutate(dist = start - lag(start))
enr_trans %>%
group_by(transcript) %>%
arrange(start) %>%
mutate(dist = start - lag(start)) %>% # distance to previous motif
mutate(previous_motif = lag(motif_rank)) %>% # what is the previous motif
filter(!is.na(dist))
# Calculate size of the gaps between all motifs for each transcript
enr_trans_dist <- enr_trans %>%
group_by(transcript) %>%
arrange(start) %>%
mutate(dist = start - lag(start)) %>% # distance to previous motif
mutate(previous_motif = lag(motif_rank)) %>% # what is the previous motif
dplyr::filter(!is.na(dist))
# New facet label names for motif_rank variables
facet.labs.r <- paste("Motif: ", enr_trans_dist$motif_rank)
names(facet.labs.r) <- c(enr_trans_dist$motif_rank)
